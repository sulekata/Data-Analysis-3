"0",""
"0","# add logs and squares of numerical variables"
"0","data <- data %>% mutate( ln_rating_count = log(rating_count), "
"0","                         stars_sq = stars^2,"
"0","                         ln_distance = ifelse(distance == 0, log(0.01),log(distance)),"
"0","                         ln_distance_alter = log(distance_alter),"
"0","                         rating_sq = rating^2)"
"0",""
"0","# create loess plots for log numerical variables"
"0","plist_ln = sapply(ln_num_vars, function(col) {"
"0","  ggplot(data, aes_string(x = col, y = ""price"")) + geom_smooth(method=""loess"", colour = color[1]) + geom_point() +"
"0","    labs( x = paste0(""\n"", col), y = ""price per night \n"", title = paste0(""Pattern of association between price and "", col)) +"
"0","    theme( panel.grid.minor.x = element_blank(), "
"0","           plot.title = element_text( size = 12, face = ""bold"", hjust = 0.5 ) ) +"
"0","    theme_bw()"
"0","}, simplify=FALSE)"
"0",""
"0","plist_ln[['ln_distance']]"
