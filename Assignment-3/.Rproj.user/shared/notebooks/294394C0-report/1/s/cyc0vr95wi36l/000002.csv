"0","# inspect functional forms for OLS ----------------------------------------"
"0",""
"0","num_vars <- c(""rating_count"", ""stars"", ""distance"", ""distance_alter"", ""rating"")"
"0","ln_num_vars <- c(""ln_rating_count"", ""ln_distance"", ""ln_distance_alter"") "
"0",""
"0","# create loess plots for level numerical variables"
"0","plist = sapply(num_vars, function(col) {"
"0","  ggplot(data, aes_string(x = col, y = ""price"")) + geom_smooth(method=""loess"", colour = color[1]) + geom_point() +"
"0","    labs( x = paste0(""\n"", col), y = ""price per night \n"", title = paste0(""Pattern of association between price and "", col)) +"
"0","    theme( panel.grid.minor.x = element_blank(), "
"0","           plot.title = element_text( size = 12, face = ""bold"", hjust = 0.5 ) ) +"
"0","    theme_bw()"
"0","}, simplify=FALSE)"
"0",""
"0","plist[['rating']]"
